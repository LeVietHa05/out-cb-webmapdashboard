// schema.prisma
datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

generator client {
  provider = "prisma-client-js"
}

model Device {
  id             Int               @id @default(autoincrement())
  title          String
  description    String?
  lat            Float
  lng            Float
  images         Image[]
  envirs         EnvironmentData[]
  isFogging      Boolean           @default(false)
  isRoadSlippery Boolean           @default(false)
  isLandslide    Boolean           @default(false)
  lastUploadAt   DateTime?
  createdAt      DateTime          @default(now())
  updatedAt      DateTime          @updatedAt
}

model Image {
  id           Int      @id @default(autoincrement())
  url          String
  title        String?
  content      String?
  licensePlate String?
  device       Device   @relation(fields: [deviceId], references: [id], onDelete: Cascade) // ← THÊM onDelete: Cascade
  deviceId     Int
  createdAt    DateTime @default(now())
}

model EnvironmentData {
  id          Int      @id @default(autoincrement())
  temperature Float
  humidity    Float
  isRaining   Boolean
  device      Device   @relation(fields: [deviceId], references: [id], onDelete: Cascade) // ← THÊM onDelete: Cascade
  deviceId    Int
  createdAt   DateTime @default(now())
}
